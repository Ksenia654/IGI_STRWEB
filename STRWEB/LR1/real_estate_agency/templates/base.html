{% load static %}
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Prime Property Partners{% endblock %}</title>
    <meta name="description" content="Агентство недвижимости «Prime Property Partners» — продажа, аренда и сопровождение сделок. Акции, вакансии, отзывы, контакты.">
    <meta name="author" content="Prime Property Partners">
    <meta property="og:image" content="{% static 'img/logo.png' %}">
    <link rel="icon" type="image/png" href="{% static 'img/logo.png' %}">
</head>
<body>
    <header style="background-color: #fddde6;">
        <div style="display:flex; align-items:center; justify-content:space-between;">

            <div itemscope itemtype="http://schema.org/Organization">
             <img src="{% static 'img/Гарант.png' %}" alt="Логотип Prime Property Partners"
                  itemprop="logo" style="max-height:64px;" />
            <h1 itemprop="name" style="margin:0; font-size:20px;">Prime Property Partners</h1>
            </div>

            <div style="display:flex; align-items:center; gap:20px;">
                <nav id="main-nav" role="navigation">
                    <ul style="list-style:none; display:flex; margin:0; padding:0; gap:15px;">
                        <li><a href="{% url 'home' %}">Главная</a></li>
                        <li><a href="{% url 'about' %}">О компании</a></li>
                        <li><a href="{% url 'news' %}">Новости</a></li>
                        <li><a href="{% url 'faq' %}">Словарь терминов</a></li>
                        <li><a href="{% url 'contacts' %}">Контакты</a></li>
                        <li><a href="{% url 'vacancies' %}">Вакансии</a></li>
                        <li><a href="{% url 'reviews' %}">Отзывы</a></li>
                        <li><a href="{% url 'promo-codes' %}">Промокоды</a></li>
                        <li><a href="{% url 'services' %}">Услуги</a></li>
                        <li><a href="{% url 'estates' %}">Каталог</a></li>
                    </ul>
                </nav>

                <div id="user-area">
                    {% if user.is_authenticated %}
                        <details style="position:relative;">
                            <summary style="cursor:pointer; list-style:none; padding:5px 10px; border:1px solid #ccc; border-radius:4px;">
                                {% if user.first_name %}{{ user.first_name }}{% else %}{{ user.username }}{% endif %}
                            </summary>
                            <ul style="position:absolute; right:0; margin:0; padding:10px; border:1px solid #ccc; background:#fff; list-style:none;">
                                <li><a href="{% url 'profile' user.profile.id %}">Профиль</a></li>
                                {% if user.is_superuser %}
                                    <li><a href="{% url 'admin:index' %}">Панель управления</a></li>
                                    <li><a href="{% url 'statistics' %}">Статистика</a></li>
                                    <li><a href="{% url 'admin_clients' %}">Управление клиентами</a></li>
                                    <li><a href="{% url 'admin_employees' %}">Управление сотрудниками</a></li>
                                {% elif user.client %}
                                    <li><a href="{% url 'client_dashboard' %}">Мои покупки</a></li>
                                {% elif user.employee %}
                                    <li><a href="{% url 'employee_dashboard' %}">Мои клиенты</a></li>
                                {% endif %}
                                <li>
                                    <form action="{% url 'logout' %}" method="post">
                                        {% csrf_token %}
                                        <button type="submit" style="background:none; border:none; cursor:pointer; padding:0;">Выйти</button>
                                    </form>
                                </li>
                            </ul>
                        </details>
                    {% else %}
                        <a href="{% url 'login' %}">Вход</a> |
                        <a href="{% url 'signup' %}">Регистрация</a>
                    {% endif %}
                </div>

            </div>
        </div>
    </header>


    <main>
        {% block content %}{% endblock %}
    </main>

    {% block pagination %}
        {% if is_paginated %}
            <nav>
                <ul>
                    {% if page_obj.has_previous %}
                        <li>
                            <a href="{{ request.path }}?page={{ page_obj.previous_page_number }}">«</a>
                        </li>
                    {% else %}
                        <li disabled>«</li>
                    {% endif %}

                    {% for num in page_obj.paginator.page_range %}
                        {% if page_obj.number == num %}
                            <li class="active"><span>{{ num }}</span></li>
                        {% elif num > page_obj.number|add:'-3' and num < page_obj.number|add:'3' %}
                            <li><a href="{{ request.path }}?page={{ num }}">{{ num }}</a></li>
                        {% endif %}
                    {% endfor %}

                    {% if page_obj.has_next %}
                        <li>
                            <a href="{{ request.path }}?page={{ page_obj.next_page_number }}">»</a>
                        </li>
                    {% else %}
                        <li disabled>»</li>
                    {% endif %}
                </ul>
                <div>
                    Страница {{ page_obj.number }} из {{ page_obj.paginator.num_pages }}
                </div>
            </nav>
        {% endif %}
    {% endblock %}

    <footer>
        <a href="{% url 'policy' %}"><small>Политика конфиденциальности</small></a>
    </footer>

</body>
</html>